-- DATA TYPE https://docs.microsoft.com/en-us/sql/t-sql/data-types/data-types-transact-sql?view=sql-server-ver15


CREATE DATABASE florImperialDB;


-- USER ---------------------------------------------------------------

CREATE TABLE userAsoRol (
	id_user int IDENTITY(1,1) not null,
	id_rol smallint not null,
	usua_asig_rol char(15) not null,
	fech_asig_rol date not null,
	usua_mod_asig char(15),
	fech_mod_rol date,
	ind_act_asig char(1),
	CONSTRAINT PK_UserAsRol PRIMARY KEY(id_user)
);


CREATE TABLE userUsuaRol (
	id_rol smallint IDENTITY(1,1) not null,
	desc_roll varchar(50) not null,
	usua_crea_rol char(15) not null,
	fec_crea_rol date not null,
	usua_mod_rol char(15),
	fech_mod_rol date,
	ind_act_rol char(1),
	CONSTRAINT PK_UserUsuaRol PRIMARY KEY(id_rol)
);


CREATE TABLE userUsuaPer (
	id_user int not null,
	pass varchar(80) not null,
	pers_id int not null,
	fech_camb_pass date,
	user_crea char(15) not null,
	fech_crea_user date not null,
	fech_vigencia date not null,
	fech_ult_ing date,
	ind_user_act char(1),
	CONSTRAINT PK_UserUsuaPer PRIMARY KEY(id_user)
);


-- PERSONA ----------------------------------------------------------


CREATE TABLE persPersona (
	pers_id int not null,
	numdoc_persona char(18) not null,
	id_tip_doc tinyint not null,
	pri_nombre varchar(25) not null,
	seg_nombre varchar(25),
	pri_apell varchar(25) not null,
	seg_apell varchar(25),
	id_email bigint bigint not null,
	id_ubicacion bigint not null,
	id_num_contacto bigint not null,
	id_genero char(1) not null,
	fech_nacim date not null,
	id_tip_persona char(1) not null,
	id_empresa int,
	id_tipo_rh tinyint,
	id_tip_nat_pers char(1),
	usua_crea char(15) not null,
	fech_crea date not null,
	usua_mod char(15),
	fec_mod date,
	pers_act char(1) not null,
	CONSTRAINT PK_PersPersona PRIMARY KEY(pers_id)
);


CREATE TABLE persEmpresa (
	id_empresa int IDENTITY(1,1) not null,
	nit varchar(50) not null,
	razon_social varchar(50) not null,
	direccion varchar(60) not null,
	id_ciudad char(5) not null,
	email varchar(60) not null,
	telefono varchar(15) not null,
	CONSTRAINT PK_persEmpresa PRIMARY KEY(id_empresa)
);


CREATE TABLE persTipoRH (
	id_tipo_rh tinyint IDENTITY(1,1) not null,
	desc_tipo_rh char(3) not null
	CONSTRAINT PK_persTipoRH PRIMARY KEY(id_tipo_rh)
);


CREATE TABLE persGenero (
	id_genero char(1) not null,
	desc_genero char(15) not null,
	CONSTRAINT PK_PersGenero PRIMARY KEY(id_genero)
);


CREATE TABLE persNatPers (
	id_tip_nat_pers char(1) not null,
	desc_tipo_pers char(20) not null,
	tipo_act char(1) not null,
	CONSTRAINT PK_PersNatPers PRIMARY KEY(id_tip_nat_pers)
);


CREATE TABLE persTipoDoc (
	id_tip_doc tinyint IDENTITY(1,1) not null,
	abr_tip_doc char(3) not null,
	desc_tip_doc char(25) not null,
	ind_tip_act char(1) not null,
	CONSTRAINT PK_PersTipoDoc PRIMARY KEY(id_tip_doc)
);


CREATE TABLE persRelTipPers(
	pers_id int not null,
	id_tip_pers varchar(8) not null,
	ind_act_rel varchar (8) not null,
	CONSTRAINT PK_PersRelTipPers(pers_id, id_tip_pers)
);


CREATE TABLE persTipPers(
	id_tip_pers varchar(8) not null,
	desc_tip_pers varchar(8) not null,
	ind_act_tip_pers varchar (8) not null,
	CONSTRAINT pk_persTipPers PRIMARY KEY (id_tip_pers)	
);


CREATE TABLE persEmail (
	id_email bigint IDENTITY(1,1) not null,
	email_pri varchar(80) UNIQUE not null,
	email_seg varchar(80),
	CONSTRAINT PK_persEmail PRIMARY KEY (id_email)
);


CREATE TABLE persUbicacion (
	bigint IDENTITY(1,1) not null,
	id_ciudad char(5) not null,
	direccion_resid varchar(80) not null,
	id_pais_nacim char(3) not null,
	CONSTRAINT PK_persUbicacion PRIMARY KEY (id_pers_ubicacion)
);


CREATE TABLE persContacto (
	id_contacto bigint IDENTITY not null,
	tel_movil char(15) UNIQUE not null,
	tel_fijo char(12) not null,
	CONSTRAINT PK_persContacto PRIMARY KEY (id_contacto)
);


-- UBICACION ---------------------------------------------------------

CREATE TABLE ubicDepto (
	id_depto char(7) not null,
	desc_depto varchar(20) not null,
	id_pais char(3) not null,
	ind_act_depto char(1) not null,
	CONSTRAINT PK_UbicDepto PRIMARY KEY(id_depto)
);


CREATE TABLE ubicPais (
	id_pais char(3) not null,
	desc_pais varchar(50) not null,
	ind_act_pais char(1) not null,
	CONSTRAINT PK_UbicPais PRIMARY KEY(id_pais)
);


CREATE TABLE ubicCiudad (
	id_ciudad char(5) not null,
	desc_ciudad varchar(50) not null,
	id_depto char(7) not null,
	ind_act_ciudad char(1) not null,
	CONSTRAINT PK_UbicCiudad PRIMARY KEY(id_ciudad)
);


CREATE TABLE ubicTipoSede (
	id_tipo_sede tinyint IDENTITY(1,1) not null,
	desc_tipo_sede varchar(50) not null,
	ind_act_tip_sede char(1) not null,
	CONSTRAINT PK_UbicTipoSede PRIMARY KEY(id_tipo_sede)
);


CREATE TABLE ubicSede (
	id_sede int IDENTITY(1,1) not null,
	nom_sede char(50) not null,
	direc_sede varchar(20) not null,
	tel_sede char(15) not null,
	id_ciudad char(5) not null,
	tipo_sede tinyint not null,
	ind_act_sede char(1) not null,
	CONSTRAINT PK_UbicSede PRIMARY KEY (id_sede)
);



-- NOMINA ---------------------------------------------------------

CREATE TABLE nomiPeriodo (
	id_periodo int IDENTITY(1,1) not null,
	desc_periodo char(20) not null,
	ind_vig_per char(1) not null,
	CONSTRAINT PK_NomiPeriodo PRIMARY KEY(id_periodo)
);


CREATE TABLE nomiTipoNovedad (
	id_tip_novedad char(3) not null,
	desc_novedad varchar(50) not null,
	ind_tip_nov char(1) not null,
	CONSTRAINT PK_NomiTipoNove PRIMARY KEY(id_tip_novedad)
);


CREATE TABLE nomiNovNomina (
	id_reg_novedad int IDENTITY(1,1) not null,
	cod_uni_emp int not null,
	id_periodo int not null,
	id_tip_novedad char(3) not null,
	cantidad float not null,
	CONSTRAINT PK_NomiNovNomina PRIMARY KEY(id_reg_novedad)
);


create table nomiParamNomina (
	cod_uni_emp int IDENTITY(1,1) not null,
	pers_id int not null,
	id_eps smallint not null,
	id_afp smallint not null,
	sal_ant int not null,
	sal_act int not null,
	cen_cost char(16) not null,
	fech_ingr date not null,
	fech_egre date not null,
	dias_vac_acum smallint not null,
	CONSTRAINT PK_NomiParamNomina PRIMARY KEY (cod_uni_emp)   
);


CREATE TABLE nomiListEps(
	id_eps smallint IDENTITY(1,1) not null,
	nit_eps char(15) not null,
	desc_eps char(25) not null,
	ind_act_eps char(1) not null,
	CONSTRAINT PK_NomiListEps PRIMARY KEY (id_eps)	
);



CREATE TABLE nomiListAFP(
	id_afp smallint IDENTITY(1,1) not null,
	nit_afp char(15) not null,
	desc_afp char(25) not null,
	ind_act_afp char(1) not null,
	CONSTRAINT PK_NomiListAFP PRIMARY KEY (id_afp)	
);


CREATE TABLE nomiPagoNom(
	id_reg_pago int IDENTITY(1,1) not null,
	id_periodo int not null,
	cod_uni_emp int not null,
	val_desc_eps_empl float(8) not null,
	val_pago_eps_empr float(8) not null,
	val_desc_afp_empl float(8) not null,
	val_pago_afp_empr float(8) not null,
	val_pago_caj_comp float(8) not null,
	val_desc_sena float(8) not null,
	val_desc_icbf float(8) not null,
	val_desc_fon_sol float(8) not null,
	porcent_rtefte numeric(2,1) not null,
	val_desc_rtefte float(8) not null,
	val_Sub_trans float(8) not null,
	val_tot_novedad float(8) not null,
	fech_pago timestamp,
	CONSTRAINT PK_NomiPagoNom PRIMARY KEY (id_reg_pago)	
);



-- PRODUCTO --------------------------------------------------


CREATE TABLE prodCaracteristica(
	id_prod_caract int IDENTITY(1,1) not null,
	id_producto int not null,
	diametro_tallo numeric(8,2) not null,
	diametro_flor numeric(8,2) not null,
	largo_tallo numeric(8,2) not null,
	color char(8),
	ind_caracter_act char(1) not null,
	CONSTRAINT PK_ProdCaracteristica PRIMARY KEY(id_prod_caract)
);


CREATE TABLE prodProducto(
	id_producto int IDENTITY(1,1) not null,
	cod_interno char(6) not null,
	id_proveedor int not null,
	desc_producto varchar(50) not null,
	unidad_medida char(4) not null,
	ind_act_prod char(1) not null,
	CONSTRAINT PK_ProdProductos PRIMARY KEY (id_producto)
);


CREATE TABLE prodMovimiento(
	id_traza_mov numeric(8,2) not null,
	num_doc_mov char(25) not null,
	tipo_movimiento char(25) not null,
	id_producto int not null,
	user_mov int not null,
	fech_mov date not null,
	sede_mov int not null,
	CONSTRAINT PK_ProdMovimiento PRIMARY KEY(id_traza_mov)	
);



CREATE TABLE prodStockProducto(
	id_producto int not null,
	id_sede int not null,
	stock_actual numeric(8,2) not null,
	stock_anterior numeric(8,2) not null,
	CONSTRAINT PK_ProdStockProducto PRIMARY KEY(id_producto, id_sede)
);



-- VENTAS --------------------------------------------------------

CREATE TABLE vtasEstadoFact(
	id_estado_fact smallint IDENTITY(1,1) not null,
	desc_estado char(20) not null,
	ind_est_fact char(1) not null,
	CONSTRAINT PK_VtasEstadoFact PRIMARY KEY (id_estado_fact)
);


CREATE TABLE vtasDetallTransacc(
	id_transaccion int IDENTITY(1,1) not null,
	id_producto INT not null,
	valuni_prod_trx bigint not null,
	cantidad_prod int not null,
	fech_carga_prod timestamp not null,
	user_carga_prod int not null,
	CONSTRAINT PK_VtasDetallTransacc PRIMARY KEY(id_transaccion)
);


CREATE TABLE vtasFactVenta(
	id_transaccion int IDENTITY(1,1) not null,
	num_fact char(25) not null,
	id_cliente int not null,
	valor_neto bigint  not null,
	valor_iva bigint not null,
	valor_rtefte bigint not null,
	fech_fact date not null,
	user_fact int not null,
	estado_fact smallint not null,
	fech_mod date,
	user_mod int not null,
	fech_contabil date,
	CONSTRAINT pk_vtasfactvent_01 PRIMARY KEY (id_transaccion)
);















